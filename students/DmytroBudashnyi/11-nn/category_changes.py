drop_categories = (
    'Тест',
    '@ Плата для заїзду автотранспорту на кладовища міста',
    '@ Формована обрізка кущів',
    'Індивідуальне будівництво',
    'Інші питання (СМ)',
    'Автобусні станції',
    'Архів містобудівної документації, матеріалів містобудівного кадастру',
    'Благоустрій (СМ)',
    'Видача свідоцтв на право власності на індивідуальний житловий будинок',
    'Визначення статусу громадян, які потерпіли від катастрофи на ЧАЕС',
    'Вирішення суперечок про місце проживання дітей',
    'Влаштування в будинки інтернати осіб похилого віку та інвалідів',
    'Встановлення обмежувачів для про’зду авто',
    'Відключення опалення за борги',
    'Відмова в оформленні/наданні ”Картки киянина (КК)”',
    'Відпочинок та оздоровлення дітей до 6 років',
    'Відсутність на станціях покажчиків руху, об’яв про час відкриття  та закриття',
    'ГЛ ”Безкоштовні стоматологічні послуги”',
    'Голосіївський парк культури та відпочинку ім..М.Рильського',
    'Довідок про наявність обмежень  на земельну ділянку',
    'Довідок щодо використання  громадянами права безкоштовної приватизації землі  в',
    'Допомога на поховання безробітніх осіб,що не перебували на обліку в центрі зайня',
    'Дорожньо-транспортні пригоди (ДТП)',
    'Дрібне хуліганство',
    'Діяльність благодійного фонду «Соціальне партнерство» (”Стефанія”)',
    'Діяльність браконьєрів на місцевих водоймищах',
    'Забезпечення житлом переселенців з АР Крим та східних регіонів країни',
    'Загублене питання #227',
    'Закриття та перепрофілювання об’єктів з надання побутових послуг населенню',
    'Запитання Голові КМДА',
    'Запитання Голубченку Анатолію Костянтиновичу',
    'Захист житлових та майнових прав дітей опікунськими радами',
    'Захист житлових та майнових прав дітей судами',
    'Захист прав споживачів у сфері торгівлі продовольчими товарами',
    'Збереження або розширення мережі аптечних закладів',
    'Звільнення з роботи',
    'Зміна режиму роботи трамваїв.',
    'Літній відпочинок дітей інвалідів',
    'Нагороди, подяки',
    'Надання дозволів на використання повітряного простору в межах',
    'Надання допомоги на погашення заборгованості по оплаті за ЖКП',
    'Надання допомоги на придбання предметів першої необхідності',
    'Надання допомоги на придбання продуктів харчування',
    'Невизначеність зон для катання на човнах,занять водними видами спорту',
    'Недостатньо компетентні працівники для чіткого роз’яснення по проблемі',
    'Незадовільна вентиляція на станціях',
    'Незадовільна організація роботи та якість обслуговування (1557)',
    'Незадовільна робота районних управлінь соціального захисту населення',
    'Нетактовна поведінка працівників кас  та контрольних пунктів',
    'Обговорення проектів розпоряджень',
    'Обговорення проектів рішень Київради по гуртожиткам',
    'Облаштування спеціалізованих місць для проведення гулянь з розпалюванням вогнищ',
    'Оперативне розсилання копій розпоряджень зазначеним в розрахунку розсилки органі',
    'Оплата праці працівникам психоневрологічних диспансерів і лікарень',
    'Переведення лицьового рахунку з однієї фізичної особи на іншу',
    'Перевезення інвалідів з порушеннями опорно-рухового апарата',
    'Перейменування бульв. Давидова  -  на бульв. Віктора Некрасова',
    'Перейменування вул. Чапаєва - на В’ячеслава Липинського',
    'Питання роботи муніципальної лікарняної каси',
    'Питання стосовно нарахування боргу за споживання ХВП',
    'Питання, що входять до компетенції ПАТ ”КБ Хрещатик” при оформленні картки кияни',
    'Питання, що відносяться до стратегії розвитку м.Києва до 2025 року:',
    'Порушення швидкості руху автобусу',
    'Порушення швидкості руху водіями тролейбусу',
    'Порядок й особливості надання послуг з вивозу твердих побутових відходів',
    'Поховання покійних з інших міст України на кладовищах міста',
    'Пошкодження, обрив повітряних ліній',
    'Правила торговельного обслуговування населення пільгових категорій',
    'Працевлаштування в сфері благоустрою міста',
    'Працевлаштування в інші бюджетні установи міста',
    'Прийом та звільнення з роботи керівників (начальників ГУ- посадових осіб, яких п',
    'Про впровадження абонентських книжок АК ”Київенерго”,на оплату за електроенергію',
    'Про заробітну плату на промислових підприємствах міста',
    'Про покинуту, залишену та знайдену дитину',
    'Проведення міських заходів із залученням громадських організацій жінок, інваліді',
    'Проведення робіт з ремонту і фарбування пляжних споруд та реманенту',
    'Пропозиції назв станцій Київського метрополітену в напрямку Ж/М Троєщина',
    'Пропозиції щодо подальшої долі Гостинного двору',
    'Проти встановлення наметів під час проведення масових заходів',
    'Проходження інтернатури й ординатури',
    'Підготовка дозволів на проектування об’єктів архітектури',
    'Підприємницька діяльність',
    'Підтвердження страхового стажу у випадку відсутності трудовий книжкии',
    'Пільговий проїзд у автобусах',
    'Режим роботи аптечного закладу',
    'Реконструкція релігійних закладів',
    'Реєстрація  та облік домашніх тварин',
    'Реєстрація права користування землею та договорів оренди',
    'Реєстрація суб’єктів прав власності на землю',
    'Робота Служб у справах неповнолітніх м. Києва',
    'Робота відділів реєстрації актів цивільного стану (РАЦС)',
    'Розміщення попільничок на території пляжу та зон відпочинку',
    'Розшук поштових відправлень',
    'Санітарний стан салонів трамваїв',
    'Санітарний стан території навчальних закладів',
    'Складання та виконання  бюджету м. Києва',
    'Соціальна допомога на дітей–сиріт та дітей, позбавлених батьківського піклування',
    'Соціальна допомога інвалідам з дитинства та дітям-інвалідам',
    'Стан поштових скриньок центрального відділення зв’язку',
    'Створення та діяльність садових товариств',
    'Утримання об’єктів комунальної власності м. Києва (КМДА і Будинок профспілок)',
    'Харчування пацієнтів психоневрологічних диспансерів і лікарень',
    'Чищення снігу та льодяного покрову в підземних переходах по лінії швидкісного тр',
    'Які брали участь у ліквідації наслідків аварії на ЧАЕС',
)

merge_categories = {
    '@ Зняття дерев': (
        '@ Зняття дерев без застосування автопідіймача',
        '@ Зняття дерев з застосуванням автопідіймача',
    ),
    'Безоплатне або пільгове забезпечення': (
        'Безоплатне або пільгове забезпечення автомобілем',
        'Безоплатне або пільгове забезпечення ортопедичним взуттям',
        'Безоплатне або пільгове забезпечення протезами',
        'Безоплатне або пільгове забезпечення інвалідним візком',
        'Безоплатне або пільгове забезпечення іншими засобами реабілітації',
        'Безоплатне або пільгове забезпечення іншими технічними засобами (тюнери)',
    ),
    'Встановлення лавок на зупинках': (
        'Встановлення лавок на автобусній зупинці',
        'Встановлення лавок на трамвайній зупинці',
        'Встановлення лавок на тролейбусних зупинках',
    ),
    'Безоплатне лікування': (
        'Безоплатне лікування у медичних закладах',
        'Безоплатне проведення аналізів, процедур у медичних закладах',
    ),
    'Відновлення транспортних маршрутів': (
        'Відновлення автобусних маршрутів',
        'Відновлення трамвайних маршрутів',
        'Відновлення тролейбусних маршрутів',
    ),
    'Інформаційне забезпечення салонів транспорту': (
        'Інформаційне забезпечення салонів автобусів',
        'Інформаційне забезпечення салонів трамваїв',
        'Інформаційне забезпечення салонів тролейбусів',
    ),
    'Зменшення інтервалу руху транспорту': (
        'Зменшення інтервалу руху автобусів',
        'Зменшення інтервалу руху маршрутних таксі',
        'Зменшення інтервалу руху трамваїв',
        'Зменшення інтервалу руху тролейбусів',
    ),
    'Зміна траси інсуючих транспортних маршрутів': (
        'Зміна траси існуючих автобусних маршрутів',
        'Зміна траси існуючих тролейбусних маршрутів',
        'Зміни траси існуючих трамвайних маршрутів',
    ),
    'Надання послуг ЗАТ ”Воля-кабель”': (
        'Надання послуг Інтернету ЗАТ ”Воля-кабель”',
        'Надання послуг аналогового телебачення ЗАТ ”Воля-кабель”',
        'Надання послуг цифрового телебачення ЗАТ ”Воля-кабель”',
    ),
    'Недостатня кількість транспорту': (
        'Недостатня  кількість (переповнені автобуси)',
        'Недостатня кількість трамваїв на маршруті',
    ),
    'Зовнішній вигляд транспорту': (
        'Зовнішній вигляд автобусів',
        'Незадовільний зовнішній вигляд тролейбусів',
    ),
    'Незадовільний графік руху транспорту': (
        'Незадовільний графік руху  та швидкість поїздів',
        'Незадовільний графік роботи автобусних маршрутів',
        'Незадовільний графік роботи маршрутного таксі',
        'Незадовільний графік роботи тролейбусних маршрутів',
    ),
    'Організація нових транспортних маршрутів': (
        'Організація нових автобусних маршрутів',
        'Організація нових таксомоторних маршрутів',
        'Організація нових трамвайних маршрутів',
        'Організація нових тролейбусних маршрутів',
    ),
    'Питання проведення гей-параду': (
        'Питання проведення ГЕЙ-параду 25 травня в м.Києві',
        'Питання проведення ГЕЙ-параду в м.Києві («Київ-прайд-2014»)',
    ),
    'Подяки': (
        'Подяки Начальнику ЖЕКу',
        'Подяки Тролейбус',
        'Подяки бухгалтеру ЖЕКу',
        'Подяки головам та працівникам РДА',
        'Подяки головному інженеру ЖЕКу',
        'Подяки двірникам ЖЕКу',
        'Подяки диспетчерам ЖЕКу',
        'Подяки електрикам ЖЕКу',
        'Подяки загалом працівникам ЖЕКу',
        'Подяки заступникам голови КМДА',
        'Подяки заступнику начальника ЖЕКУ',
        'Подяки зварювальникам ЖЕКу',
        'Подяки майстрам ЖЕКу',
        'Подяки малярам ЖЕКу',
        'Подяки покрівельникам ЖЕКу',
        'Подяки працівникам КБУ ”Контактний центр міста Києва”',
        'Подяки працівникам КМДА (працівникам та начальникам управлінь)',
        'Подяки працівникам закладів освіти',
        'Подяки працівникам метрополітену',
        'Подяки працівникам охорони здоров’я',
        'Подяки працівникам профільних служб міста (Київенерго, Київводоканал, Київгаз)',
        'Подяки працівникам соціальної сфери',
        'Подяки сантехнікам ЖЕКу',
        'Подяки слюсарям ЖЕКу',
        'Подяки столярам ЖЕКу',
        'Подяки іншим працівникам транспортної сфери',
        '@ Подяки за роботу КО ”Київзеленбуд”',
    ),
    'Відсутнє ХВП': (
        'Відсутнє ХВП',
        'Відсутність ХВП по стояку',
    ),
    'Відсутній тиск ХВП': (
        'Відсутній тиск ХВП до 9-го поверху включно (”Київводоканал” )',
        'Відсутній тиск ХВП з 10-го поверху включно (”Київенерго”)',
    ),
    'Відсутнє ГВП': (
        'Відсутність ГВП',
        'Відсутність ГВП по стояку',
    )
}


rename_category_dict = {}
for new_category, category_list in merge_categories.items():
    for category in category_list:
        rename_category_dict[category] = new_category


def clean_call_data(call_data):
    cleaned_data = []
    for call in call_data:
        text, category = call
        if category in drop_categories:
            continue

        new_category = rename_category_dict.get(category, category)
        cleaned_data.append((text, category, new_category))

    return cleaned_data